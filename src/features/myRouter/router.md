# React-Router

> 前端路由是什么？
>
> React Router 如何实现路由？
>
> 基于路由思考资源的组织？
>
> React Router核心API ?
>
> Examples?



react-router是react生态圈中非常重要的一个部分，用来实现前端路由。react-router虽然不是facebook官方出品的，但是已经是react应用中实现路由的一个标准。

什么是路由呢？事实上就是当我们在页面上进行URL切换的时候，需要在页面上显示不同的内容。传统意义上来说，路由是一个后端的概念。当发送URL请求到服务器端时候，服务端会根据不同的URL来返回不同页面。随着前端应用越来越复杂，单页面应用的出现，前端也需要用路由来隔离不同的业务功能。



## 为什么需要路由

1. 单页应用需要进行页面切换

2. 通过URL可以定位到页面

   这样的话，虽然是单页面应用，切换页面不需要浏览器刷新，但是URL的地址仍然会定位到当前访问的页面，当强制刷新浏览器或者将URL分享给其他人的时候，仍然可以访问到对应的页面。

3. `更有语义的组织资源`

   路由不仅仅是页面的切换，还可以更有语义的去组织你的资源。因为每个页面的功能其实是高内聚松耦合的，可以通过URL将它们很好的隔离。不仅是业务功能，包括做lazy load或者其他的资源组织，路由都可以很好的帮助你。



[示例]()



## 路由架构

路由在前端实现的基本原理是什么样的呢？

![image-20231202172912722](images/image-20231202172912722.png)

1. 路由定义

   配置文件或直接通过react标记，定义路由到组件的映射，

2. Router

   解析，根据URL不同地址，返回不同组件

3. 组件容器

   路由如何render到页面呢？通过定义组件容器。组件容器通常是页面布局的一部分，这部分是由react-router来控制具体展示什么。当URL变化时，组件容器内容发生变化。



[代码]()



## React-Router特性

1. 声明式路由定义

   路由的使用，像使用react标记一样，可以作为一个Tag使用，使用的时候非常灵活，可以用在页面的任何地方使用一个路由，在任何地方都可以根据URL的地址来显示或者隐藏某个组件，不需要一个特殊的路由表去声明。

2. 动态路由

   在页面render时候才会被实时解析的。



## 三种路由实现方式

1. URL路径

2. hash路由

   1. #
   2. 对于有的低版本浏览器，不支持路由改变但不刷新，就需要用hash路由

3. 内存路由

   MemoryRouter，常用于，服务端渲染时候，路由不体现在url中，在内存中



## 基于路由配置进行资源组织

路由不仅仅是页面的切换，而且能帮助你进行更合理的资源的组织。

1. 实现业务逻辑的松耦合

   把页面相关的部分组织在一起，无论是业务、代码或者一些lazy load，都可以基于路由实现。

2. 易于扩展、重构和维护

   没有把路由放在业务逻辑中实现，而是把它抽象出来，通过React Router 来实现路由的配置，这样当增加新的页面时候，就非常清楚，可以通过增加路由配置。重构和维护也是类似的，重构的逻辑单元是一个个小的页面，不是一个整体，容易重构和维护。

3. 路由层面实现Lazy Load

   在统一的地方定义路由，这样加载不同的组件时，可以在这个统一的地方去实现lazy load，这样首页展现速度会比较快。



## React Router API

- Link 普通链接，不会触发浏览器更新
- NavLik 类似Link，但是会添加当前选中状态
- Prompt 满足条件时提示用户是否离开当前页面
- Redirect 重定向当前页面，eg: 登陆判断
- Route 路由配置的核心标记，路径匹配时显示对应组件
  - ⚠️ Tips： 不是排他的，当路径匹配时，都会显示
- Switch 只显示第一个匹配的路由



## Examples

### 基础用法

demo - BasicRoute

需要注意以下几点：

1. **JSON 🆚 声明式路由**

   声明式的路由虽然很直观，但是对于顶层路由建议使用JSON的方式来定义，这样更易于理解和维护。

   顶层的路由往往意味着页面级别的路由，关系到整个应用程序的流程和结构。如果页面内部有子路由，仍然可以使用React Router的声明式标记去定义更细节的路由。

2. **Layout**

   一般来说，我们更关注页面级别的路由。JSON定义顶层路由配置，布局页面如何使用是由页面自己决定的，这样可以把路由配置和容器布局解藕。（例如常见的侧边栏导航，或者页面顶部导航条等）。

3. **Link 🆚 NavLink 🆚 CustomLink**

4. **Not Found**

   

### URL传递参数

将参数作为URL的一部分而非查询字符串，对搜索引擎更友好，URL也更加有语义。

1. 如何传参数？
2. 如何获取参数？
3. [参数的语法有哪些？](https://github.com/pillarjs/path-to-regexp)

```jsx
// 如何传递参数
<Route path="/topic/:id" />

// 获取参数
this.props.match.pramas

```

> 什么时候需要URL参数？
>
> 有时候页面的状态可以通过组件内部的一个state就可以实现，URL参数有时候只是一个可选的方案。这种情况下如何选择？
>
> 建议：页面状态尽量通过URL参数定义（考虑场景：URL转发）

### 嵌套路由

当实现一些较为复杂的应用的时候，

侧边栏+Tab/下拉框or其他形式

1. 每个React组件都可以是路由容器
2. React Router的声明式语法可以方便的定义嵌套路由

### 鉴权

### Lazy Load

### 4XX/5xx页面

### 分布操作

向导页面需要考虑的技术要点

- 使用URL进行导航的好处

  任何时刻都可以通过URL定位到当前页面。相比于放在内存中，刷新页面就回到第一步，相对友好很多。

- 表单内容存放的位置

  每一步的操作可能都是表单，那每一步的表单数据如何管理？

- 页面状态如何切换

### Prompt

### 其他

